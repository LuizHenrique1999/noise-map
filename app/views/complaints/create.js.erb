if(map.hasLayer(marker)){
  map.removeLayer(marker)
}

var new_marker_latitude = <%= @marker.latitude %>
var new_marker_longitude = <%= @marker.longitude %>

clusterLayer.addLayer(L.marker([new_marker_latitude, new_marker_longitude]).bindPopup("<%= @marker.description %>"))
clusterLayer.refreshClusters();

heatmapData.data.push({lat: new_marker_latitude, lng: new_marker_longitude, value: 1})
heatmapLayer.setData(heatmapData);

var address_field = document.querySelector('#address_complaint');
var description_field = document.querySelector('#complaint_description');
var noise_type_field = document.querySelector('#complaint_noise_type');

latitude_field.value = ""
longitude_field.value = ""
address_field.value = ""
description_field.value = ""
noise_type_field.value = 1

sidebar.close();